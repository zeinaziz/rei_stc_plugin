var $emailHasFocus=!1,$phoneHasFocus=!1;function stopRKey(e){(e=e||(event||null)).target?e.target:e.srcElement&&e.srcElement;return 13!=e.keyCode||!$emailHasFocus&&!$phoneHasFocus}document.onkeypress=stopRKey;var rawFile,file,$SMSNotificationGetActive=!1;function getSMSNotificationFile(){file=(file=document.getElementById("stc_js_folders_hidden").value.split("|")[1]).replace("status.txt",document.getElementById("stc_subscriber_id_hidden").value+"-status.txt")+"?dummy="+Date.now(),(rawFile=new XMLHttpRequest).open("GET",file),rawFile.onload=stc_file_load_handler,rawFile.send()}function stc_file_load_handler(){200==this.status?(null!=document.getElementById("stc-mobile-phone-label")&&($response=this.responseText.split("|"),$str=document.getElementById("stc-mobile-phone-label").innerHTML.slice(0,document.getElementById("stc-mobile-phone-label").innerHTML.lastIndexOf(":")+1),document.getElementById("stc-mobile-phone-label").innerHTML=$str+" "+$response[0]),$SMSNotificationGetActive=!1):alert("Error reading status file:"+file),setTimeout(getSMSNotificationStatus,5e3)}function getSMSNotificationStatus(){$SMSNotificationGetActive||($SMSNotificationGetActive=!0,getSMSNotificationFile())}var i,toggler=document.getElementsByClassName("stc-caret");for(i=0;i<toggler.length;i++)toggler[i].addEventListener("click",function(){this.parentElement.querySelector(".stc-nested").classList.toggle("stc-active"),this.classList.toggle("stc-caret-down")});for(toggler=document.getElementsByClassName("stc-caret-u"),i=0;i<toggler.length;i++)toggler[i].addEventListener("click",function(){this.parentElement.querySelector(".stc-nested-u").classList.toggle("stc-active-u"),this.classList.toggle("stc-caret-down-u")});jQuery(function(e){var t,c=document.querySelector("#stc_mobile_phone"),s=document.querySelector("#error-msg"),o=["Invalid number","Invalid country code","Too short","Too long","Invalid number"];if(c){t=window.intlTelInput(c,{initialCountry:"auto",geoIpLookup:function(t,c){e.getJSON("https://freegeoip.app/json/",function(e){var c=e&&e.country_code?e.country_code:"us";t(c)})},utilsScript:document.getElementById("stc_js_folders_hidden").value.split("|")[0]}),c.addEventListener("blur",function(){if(n(),c.value.trim())if(t.isValidNumber())document.querySelector("#stc_mobile_phone_hiddden").value=t.getNumber();else{c.classList.add("error");var e=t.getValidationError();s.innerHTML=o[e],s.classList.remove("hide")}});var n=function(){c.classList.remove("error"),s.innerHTML="",s.classList.add("hide"),document.querySelector("#stc_mobile_phone_hiddden").value=""};c.addEventListener("change",n),c.addEventListener("keyup",n)}var r=!1;e("#stc-unsubscribe-checkbox").click(function(){1==e(this).prop("checked")?(r=!!e("#stc-update-btn").is(":visible"),e(".stc-categories").hide(),e("#stc-subscribe-btn").hide(),e("#stc-update-btn").hide(),e("#stc-unsubscribe-btn").show()):(e(".stc-categories").show(),r?e("#stc-subscribe-btn").hide():e("#stc-subscribe-btn").show(),e("#stc-unsubscribe-btn").hide(),r?e("#stc-update-btn").show():e("#stc-update-btn").hide())}),e("#stc-all-categories").click(function(){1==e(this).prop("checked")?(e("div.stc-categories-checkboxes").hide(),e("div.stc-categories-checkboxes input[type=checkbox]").each(function(){e(this).prop("checked",!0)})):(e("div.stc-categories-checkboxes").show(),e("div.stc-categories-checkboxes input[type=checkbox]").each(function(){e(this).prop("checked",!1)}))}),e("div.stc-notification-checkboxes input[type=checkbox]").click(function(t){switch(t.target.id){case"Sun":case"Mon":case"Tue":case"Wed":case"Thu":case"Fri":case"Sat":e("div.stc-notification-checkboxes").find(e("#Daily")).prop("checked",!1),e("div.stc-notification-checkboxes").find(e("#Hourly")).prop("checked",!1),e("div.stc-notification-checkboxes").find(e("#STC")).prop("checked",!1);break;case"Daily":e("div.stc-notification-checkboxes input[type=checkbox]").each(function(){e(this).prop("checked",!1)}),e("div.stc-notification-checkboxes").find(e("#Daily")).prop("checked",!0);break;case"Hourly":e("div.stc-notification-checkboxes input[type=checkbox]").each(function(){e(this).prop("checked",!1)}),e("div.stc-notification-checkboxes").find(e("#Hourly")).prop("checked",!0);break;case"STC":e("div.stc-notification-checkboxes input[type=checkbox]").each(function(){e(this).prop("checked",!1)}),e("div.stc-notification-checkboxes").find(e("#STC")).prop("checked",!0)}e(this).prop("checked")}),e("#stc-email").change(function(){data={action:"stc_get_results",email:e("#stc-email").val(),original_id:e("#stc_original_subscriber_id_hidden").val()};var c=document.getElementById("stc_js_folders_hidden").value.split("|")[2];e.post(c,data,function(c){xObj=JSON.parse(c),"exsist"==xObj.user_state?e("#stc-unsubscribe-checkbox").prop("checked")?(r=!0,e("#stc-subscribe-btn").hide(),e("#stc-update-btn").hide(),e("#stc-unsubscribe-btn").show()):(r=!1,e("#stc-subscribe-btn").hide(),e("#stc-update-btn").show(),e("#stc-unsubscribe-btn").hide()):"new"==xObj.user_state?(r=!1,e("div.stc-categories-checkboxes").show(),e("#stc-unsubscribe-checkbox").prop("checked",!1),e("#stc-all-categories").prop("checked",!1),e("#stc-subscribe-btn").show(),e("#stc-update-btn").hide(),e("#stc-unsubscribe-btn").hide(),e(".stc-categories").show()):(e("#stc-email").val(e("#stc-email").val()+" : "+script_vars.approvalStr),e("#stc-subscribe-btn").hide(),e("#stc-update-btn").hide(),e("#stc-unsubscribe-btn").hide()),t&&(t.setNumber(xObj.stc_mobile_phone),document.querySelector("#stc_mobile_phone_hiddden").value=xObj.stc_mobile_phone,$str=document.getElementById("stc-mobile-phone-label").innerHTML.slice(0,document.getElementById("stc-mobile-phone-label").innerHTML.lastIndexOf(":")+1),document.getElementById("stc-mobile-phone-label").innerHTML=$str+" "+xObj.stc_mobile_phone_status),document.querySelector("#stc_subscriber_id_hidden").value=xObj.stc_subscriber_id,e("#stc-keywords").val(xObj.keywords),e("div.stc-area-checkboxes input[type=checkbox]").each(function(){e(this).prop("checked",!1),"exsist"==xObj.user_state&&($currentCheckBox=e(this),xObj.search_areas&&xObj.search_areas.forEach(function(e){e.name==$currentCheckBox.val()&&$currentCheckBox.prop("checked",!0)}))}),e("div.stc-notification-checkboxes input[type=checkbox]").each(function(){e(this).prop("checked",!1),"exsist"==xObj.user_state&&($currentCheckBox=e(this),xObj.notifications&&xObj.notifications.forEach(function(e){e.name==$currentCheckBox.val()&&$currentCheckBox.prop("checked",!0)}))}),e("div.stc-categories-checkboxes input[type=checkbox]").each(function(){e(this).prop("checked",!1),"exsist"==xObj.user_state&&($currentCheckBox=e(this),xObj.categories&&xObj.categories.forEach(function(e){e.term_id==$currentCheckBox.val()&&$currentCheckBox.prop("checked",!0)}))})})}),e("#stc-email").focusin(function(){$emailHasFocus=!0}),e("#stc-email").focusout(function(){$emailHasFocus=!1}),e("#stc_mobile_phone").focusin(function(){$phoneHasFocus=!0}),e("#stc_mobile_phone").focusout(function(){$phoneHasFocus=!1}),e(document).ready(function(){for($SMSNotificationGetActive=!1,c&&setTimeout(getSMSNotificationStatus,1e3),toggler=document.getElementsByClassName("stc-caret-u"),i=0;i<toggler.length;i++)toggler[i].parentElement.querySelector(".stc-nested-u").classList.toggle("stc-active-u"),toggler[i].classList.toggle("stc-caret-down-u")})});